<story-context id="{bmad_folder}/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>1</epicId>
    <storyId>2</storyId>
    <title>Core Frontend Setup</title>
    <status>drafted</status>
    <generatedAt>mandag 8. desember 2025</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/1-2-core-frontend-setup.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>a developer</asA>
    <iWant>the Next.js frontend to be set up and connected to a Vercel deployment pipeline</iWant>
    <soThat>I can build UI components and have continuous deployment</soThat>
    <tasks>
      <task id="1" parent_id="0" ac_ref="1">Project Initialization:
        <subtask id="1.1">Create a `frontend/` directory at the project root.</subtask>
        <subtask id="1.2">Run `npx create-next-app@latest` within the `frontend/` directory.</subtask>
        <subtask id="1.3">Select options for TypeScript and Tailwind CSS during setup.</subtask>
        <subtask id="1.4">Verify the new Next.js application runs locally (`npm run dev`).</subtask>
        <subtask id="1.5">Testing: Run `npm run lint` and `npm run test` to ensure code quality and no regressions.</subtask>
      </task>
      <task id="2" parent_id="0" ac_ref="3">Supabase Client Setup:
        <subtask id="2.1">Install the Supabase client library: `npm install @supabase/supabase-js`.</subtask>
        <subtask id="2.2">Create a `.env.local` file in the `frontend/` directory with `NEXT_PUBLIC_SUPABASE_URL` and `NEXT_PUBLIC_SUPABASE_ANON_KEY`.</subtask>
        <subtask id="2.3">Create a Supabase client utility file (e.g., `frontend/src/lib/supabaseClient.ts`) to initialize and export the client.</subtask>
      </task>
      <task id="3" parent_id="0" ac_ref="2">Vercel Integration:
        <subtask id="3.1">Create a new project on the Vercel dashboard.</subtask>
        <subtask id="3.2">Link the Vercel project to the GitHub repository.</subtask>
        <subtask id="3.3">Configure the root directory in Vercel settings to be `frontend`.</subtask>
        <subtask id="3.4">Add Supabase environment variables (`NEXT_PUBLIC_SUPABASE_URL`, `NEXT_PUBLIC_SUPABASE_ANON_KEY`) to the Vercel project settings.</subtask>
        <subtask id="3.5">Trigger a deployment and verify it succeeds.</subtask>
        <subtask id="3.6">Testing: Check the deployment logs in Vercel for any build errors or warnings.</subtask>
      </task>
      <task id="4" parent_id="0" ac_ref="3">Backend API Test:
        <subtask id="4.1">Create a test API route in the Next.js app (e.g., `/pages/api/test-backend.ts`).</subtask>
        <subtask id="4.2">In this API route, make a `fetch` request to the backend's health check endpoint (e.g., `http://localhost:8000/health`).</subtask>
        <subtask id="4.3">Create a simple frontend page/component with a button to trigger the test API route.</subtask>
        <subtask id="4.4">Testing: Verify that clicking the button successfully calls the backend and displays a success message.</subtask>
      </task>
    </tasks>
  </story>

  <acceptanceCriteria>
      <criterion id="1" source="tech-spec-epic-1.md">Given the project is initialized, When I set up the frontend, Then a Next.js app is created with TypeScript and Tailwind CSS.</criterion>
      <criterion id="2" source="tech-spec-epic-1.md">Given the project is initialized, When I set up the frontend, Then a Vercel CI/CD pipeline is connected for automated deployments.</criterion>
      <criterion id="3" source="tech-spec-epic-1.md">Given the project is initialized, When I set up the frontend, Then a basic API call from the frontend to the backend is successful.</criterion>
    </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/sprint-artifacts/tech-spec-epic-1.md</path>
        <title>Epic Technical Specification: First Plan & Foundation</title>
        <section>Story 1.2: Core Frontend Setup</section>
        <snippet>Given the project is initialized, When I set up the frontend, Then a Next.js app is created with TypeScript and Tailwind CSS. A Vercel CI/CD pipeline is connected for automated deployments. A basic API call from the frontend to the backend is successful.</snippet>
      </doc>
      <doc>
        <path>docs/architecture-2025-11-30.md</path>
        <title>Architecture</title>
        <section>Project Initialization</section>
        <snippet>The frontend project will be initialized using the `create-next-app` CLI tool... Initialization Command: `npx create-next-app@latest frontend --typescript --tailwind --eslint --app --use-npm`</snippet>
      </doc>
      <doc>
        <path>docs/architecture-2025-11-30.md</path>
        <title>Architecture</title>
        <section>Deployment Architecture</section>
        <snippet>Both the Next.js frontend and the FastAPI backend will be deployed to Vercel. A continuous integration and deployment pipeline will be set up through Vercel's Git integration...</snippet>
      </doc>
      <doc>
        <path>docs/epics.md</path>
        <title>ibe160 - Epic Breakdown</title>
        <section>Story 1.2: Core Frontend Setup</section>
        <snippet>As a developer, I want the Next.js frontend to be set up and connected to a Vercel deployment pipeline, so that I can build UI components and have continuous deployment.</snippet>
      </doc>
    </docs>
    <code>
      <artifact>
        <path>frontend/</path>
        <kind>directory</kind>
        <symbol>N/A</symbol>
        <lines>N/A</lines>
        <reason>Root directory for the Next.js application, to be created by `npx create-next-app`.</reason>
      </artifact>
      <artifact>
        <path>frontend/src/app/page.tsx</path>
        <kind>component</kind>
        <symbol>HomePage</symbol>
        <lines>N/A</lines>
        <reason>Main entry point component for the application. A button will be added here to test the backend API call.</reason>
      </artifact>
      <artifact>
        <path>frontend/src/lib/supabaseClient.ts</path>
        <kind>utility</kind>
        <symbol>supabase</symbol>
        <lines>N/A</lines>
        <reason>To be created to initialize and export the Supabase client for frontend use.</reason>
      </artifact>
       <artifact>
        <path>frontend/.env.local</path>
        <kind>config</kind>
        <symbol>N/A</symbol>
        <lines>N/A</lines>
        <reason>To be created to store Supabase connection secrets (`NEXT_PUBLIC_SUPABASE_URL`, `NEXT_PUBLIC_SUPABASE_ANON_KEY`).</reason>
      </artifact>
      <artifact>
        <path>backend/src/main.py</path>
        <kind>api-endpoint</kind>
        <symbol>read_root</symbol>
        <lines>5-7</lines>
        <reason>Provides the `GET /` health check endpoint for the backend API test.</reason>
      </artifact>
    </code>
    <dependencies>
      <ecosystem name="Node.js (frontend)">
        <package name="next" version="^14.0.0" />
        <package name="react" version="^18.0.0" />
        <package name="typescript" version="^5.0.0" />
        <package name="tailwindcss" version="^3.0.0" />
        <package name="@supabase/supabase-js" version="^2.0.0" />
        <package name="zustand" version="^4.0.0" />
        <package name="swr" version="^2.0.0" />
      </ecosystem>
      <ecosystem name="Python (backend)">
        <package name="supabase" version="latest" />
        <package name="python-dotenv" version="latest" />
        <package name="fastapi" version="^0.104.0" />
        <package name="uvicorn" version="^0.24.0" />
      </ecosystem>
    </dependencies>
  </artifacts>

  <constraints>
      <constraint>
        <type>Technology</type>
        <description>Frontend must be built with Next.js (v16.0.5+), TypeScript, and Tailwind CSS.</description>
      </constraint>
      <constraint>
        <type>State Management</type>
        <description>Use Zustand for client-side state and SWR or React Query for server-side state (data fetching).</description>
      </constraint>
      <constraint>
        <type>Authentication</type>
        <description>The frontend will interact directly with Supabase Auth for user registration and login.</description>
      </constraint>
      <constraint>
        <type>Testing</type>
        <description>Frontend unit tests will use React Testing Library with Jest.</description>
      </constraint>
    </constraints>
  <interfaces>
      <interface>
        <name>Backend Health Check</name>
        <kind>REST</kind>
        <signature>GET /</signature>
        <path>backend/src/main.py</path>
      </interface>
      <interface>
        <name>Supabase Authentication</name>
        <kind>Library API</kind>
        <signature>supabase.auth.signUp(), supabase.auth.signInWithPassword()</signature>
        <path>@supabase/supabase-js</path>
      </interface>
    </interfaces>
  <tests>
    <standards>
      Frontend unit tests will use React Testing Library with Jest. Integration tests will focus on Frontend-Backend API communication. E2E tests (e.g., using Playwright or Cypress) will be considered in a future phase.
    </standards>
    <locations>
      Frontend test files will be co-located with the components they are testing in a `__tests__` subdirectory. Backend tests reside in the root `tests/` directory.
    </locations>
    <ideas>
      <idea ac_ref="1">Verify that the Next.js application runs locally after `npx create-next-app` using `npm run dev`.</idea>
      <idea ac_ref="1">Run `npm run lint` after setup to ensure there are no initial linting errors.</idea>
      <idea ac_ref="2">After connecting to the GitHub repository, verify that a push to the main branch triggers a successful deployment on Vercel.</idea>
      <idea ac_ref="3">Create a simple button on the main page that, when clicked, calls the backend `GET /` endpoint and displays a success message on the frontend.</idea>
    </ideas>
  </tests>
</story-context>
